variables:
  MODULES_MODULE_NAME: "${CI_PROJECT_NAME}"

before_script:
  # Setup werf
  - |
    type trdl && . $(trdl use werf 1.2 stable)
    type werf && source $(werf ci-env gitlab --as-file)
    werf cr login -u ${MODULES_REGISTRY_LOGIN} -p ${MODULES_REGISTRY_PASSWORD} ${MODULES_REGISTRY}
  # Login to the registry
  - |
    crane auth login ${MODULES_REGISTRY} -u ${MODULES_REGISTRY_LOGIN} -p ${MODULES_REGISTRY_PASSWORD}
stages:
  - build
  - deploy
